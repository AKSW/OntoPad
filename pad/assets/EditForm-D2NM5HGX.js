import{_ as g,u as f,T as y,f as n,m as k,r as v,c as i,a as e,d as m,F as h,e as w,g as b,C as _,t as u,b as j,o as l}from"./index-Bwyx5tYB.js";import{l as M,d as R}from"./n3-compare-BvATeFmt.js";const C={name:"EditForm",setup(){return{store:f()}},components:{TermInput:y},mounted(){this.getResource()},watch:{resource_iri(s){this.getResource()}},data(){return{debug:!1,subject:n.namedNode(""),originalDataModel:[],dataModel:[]}},computed:{...k(j,["graph_iri","resource_iri"])},methods:{newTriple(s){s||(s=0),this.dataModel.splice(s+1,0,n.quad(this.subject,n.namedNode(""),n.namedNode(""),n.namedNode(this.graph_iri)))},delTriple(s){this.dataModel.splice(s,1)},async getResource(){this.subject=n.namedNode(this.resource_iri),this.originalDataModel=await(await this.store.getResource(this.resource_iri)).toArray(),this.dataModel=M.cloneDeep(this.originalDataModel)},async updateResource(){const s=R(this.originalDataModel,this.dataModel);try{await this.store.deleteInsertData({deleteArray:s.del,insertArray:s.add}),this.getResource()}catch(t){console.error(t)}}}},T={class:"Form"},N=e("label",{for:"resourceUriInput"},"Resource IRI (Subject)",-1),D={width:"100%"},I=e("tr",null,[e("th",{scope:"col",width:"45%"},"Predicate"),e("th",{scope:"col",width:"auto"},"Object"),e("th",{scope:"col",width:"90px"})],-1),U=["onClick"],S=["onClick"],F={key:1},E={style:{overflow:"scroll",height:"400px"}},V={class:"container"},A={class:"row"},B={class:"col"},q={class:"col"};function x(s,t,L,O,o,d){const p=v("TermInput");return l(),i(h,null,[e("div",T,[e("form",null,[N,m(p,{term:o.subject,"onUpdate:term":t[0]||(t[0]=r=>o.subject=r),type:"iri",id:"resourceUriInput"},null,8,["term"]),e("table",D,[I,(l(!0),i(h,null,w(o.dataModel,(r,a)=>(l(),i("tr",{key:a},[e("td",null,[m(p,{id:"form-pred-"+a,term:r.predicate,"onUpdate:term":c=>r.predicate=c,type:"iri"},null,8,["id","term","onUpdate:term"])]),e("td",null,[m(p,{id:"form-obj-"+a,term:r.object,"onUpdate:term":c=>r.object=c},null,8,["id","term","onUpdate:term"])]),e("td",null,[e("button",{type:"button",class:"btn btn-outline-dark mb-0",onClick:c=>d.newTriple(a)},"+",8,U),e("button",{type:"button",class:"btn btn-outline-dark mb-0",onClick:c=>d.delTriple(a)},"-",8,S)])]))),128))]),o.dataModel.length<1?(l(),i("button",{key:0,type:"button",class:"btn btn-outline-dark mb-0",onClick:t[1]||(t[1]=r=>d.newTriple())},"+")):b("",!0),e("button",{type:"button",class:"btn btn-outline-primary mb-0",onClick:t[2]||(t[2]=(...r)=>d.updateResource&&d.updateResource(...r))},"Update Resource")])]),o.debug==!1?(l(),i("a",{key:0,onClick:t[3]||(t[3]=r=>o.debug=!0)},"(show debug)")):b("",!0),o.debug?(l(),i("div",F,[e("a",{onClick:t[4]||(t[4]=r=>o.debug=!1)},"(hide debug)"),e("div",E,[e("div",V,[e("div",A,[e("div",B,[_(" new "),e("pre",null,"subject: "+u(o.subject)+`
`+u(o.dataModel)+`
          `,1)]),e("div",q,[_(" old "),e("pre",null,"subject: "+u(o.subject)+`
`+u(o.originalDataModel)+`
          `,1)])])])])])):b("",!0)],64)}const G=g(C,[["render",x]]);export{G as default};
